<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-prerequisites/docker/advanced">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">[Practice] Docker Advanced | MLOps for ALL</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://mlops-for-all.github.io/en/img/logo-mlops-for-all.png"><meta data-rh="true" name="twitter:image" content="https://mlops-for-all.github.io/en/img/logo-mlops-for-all.png"><meta data-rh="true" property="og:url" content="https://mlops-for-all.github.io/en/docs/prerequisites/docker/advanced"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="[Practice] Docker Advanced | MLOps for ALL"><meta data-rh="true" name="description" content="Practice to use docker more advanced way."><meta data-rh="true" property="og:description" content="Practice to use docker more advanced way."><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://mlops-for-all.github.io/en/docs/prerequisites/docker/advanced"><link data-rh="true" rel="alternate" href="https://mlops-for-all.github.io/en/docs/prerequisites/docker/advanced" hreflang="en"><link data-rh="true" rel="alternate" href="https://mlops-for-all.github.io/docs/prerequisites/docker/advanced" hreflang="ko"><link data-rh="true" rel="alternate" href="https://mlops-for-all.github.io/docs/prerequisites/docker/advanced" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-097K82469K"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-097K82469K",{anonymize_ip:!0})</script><link rel="stylesheet" href="/en/assets/css/styles.21f63a90.css">
<link rel="preload" href="/en/assets/js/runtime~main.54b01194.js" as="script">
<link rel="preload" href="/en/assets/js/main.2cd4f705.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo-mlops-for-all.png" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/en/img/logo-mlops-for-all.png" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">MLOps for ALL</b></a><a class="navbar__item navbar__link" href="/en/docs/introduction/intro">Tutorial</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en/docs/prerequisites/docker/install">Prerequisites</a><a class="navbar__item navbar__link" href="/en/community/contributors">Community</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/en/docs/introduction/intro">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/en/docs/prerequisites/docker/advanced">Next</a></li><li><a class="dropdown__link" href="/en/docs/1.0/prerequisites/docker/advanced">1.0</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/en/docs/prerequisites/docker/advanced" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/docs/prerequisites/docker/advanced" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ko">한국어</a></li></ul></div><a href="https://github.com/mlops-for-all/mlops-for-all.github.io/tree/main/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/en/docs/prerequisites/docker/install">Docker</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/prerequisites/docker/install">Install Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/prerequisites/docker/introduction">Why Docker &amp; Kubernetes ?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/prerequisites/docker/">What is Docker?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/prerequisites/docker/command">[Practice] Docker command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/prerequisites/docker/images">[Practice] Docker images</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/prerequisites/docker/advanced">[Practice] Docker Advanced</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Docker</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">[Practice] Docker Advanced</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Next</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>[Practice] Docker Advanced</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="making-a-good-docker-image">Making a good Docker image<a href="#making-a-good-docker-image" class="hash-link" aria-label="Direct link to Making a good Docker image" title="Direct link to Making a good Docker image">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="considerations-to-make-docker-image">Considerations to make Docker image:<a href="#considerations-to-make-docker-image" class="hash-link" aria-label="Direct link to Considerations to make Docker image:" title="Direct link to Considerations to make Docker image:">​</a></h3><p>When creating a Docker image using a Dockerfile, the <strong>order</strong> of the commands is important.<br>
<!-- -->This is because Docker images are composed of many Read-Only layers and when building the image, existing layers are <strong>cached</strong> and reused, so if you structure your Dockerfile with this in mind, you can <strong>reduce the build time</strong>.</p><p>Each of the <code>RUN</code>, <code>ADD</code>, <code>COPY</code> commands in a Dockerfile are stored as one layer.</p><p>For example, if we have the following <code>Dockerfile</code>:</p><div class="language-docker codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-docker codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Layer 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM ubuntu:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Layer 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN apt-get update &amp;&amp; apt-get install python3 pip3 -y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Layer 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN pip3 install -U pip &amp;&amp; pip3 install torch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Layer 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY src/ src/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Layer 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD python src/app.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you run the image built with the above <code>Dockerfile</code> with the command <code>docker run -it app:latest /bin/bash</code>, it can be represented in the following layers. </p><p><img loading="lazy" alt="layers.png" src="/en/assets/images/layers-d934a487c19f428867e8d460015e8747.png" width="1080" height="612" class="img_ev3q"></p><p>The topmost R/W layer does not affect the image. In other words, any changes made inside the container are volatile.</p><p>When a lower layer is changed, all the layers above it need to be rebuilt. Therefore, the order of Dockerfile instructions is important. It is recommended to place the parts that are frequently changed towards the end. (e.g., <code>COPY src/ app/src/</code>)</p><p>Conversely, parts that are unlikely to change should be placed towards the beginning.</p><p>If there are parts that are rarely changed but used in multiple places, they can be consolidated. It is advisable to create a separate image for those common parts in advance and use it as a base image.</p><p>For example, if you want to create separate images for an environment that uses <code>tensorflow-cpu</code> and another environment that uses <code>tensorflow-gpu</code>, you can do the following:
Create a base image <a href="http://ghcr.io/makinarocks/python:3.8-base-cpu" target="_blank" rel="noopener noreferrer"><code>ghcr.io/makinarocks/python:3.8-base</code></a> that includes Python and other basic packages installed. Then, when creating the images with the CPU and GPU versions of TensorFlow, you can use the base image as the <code>FROM</code> instruction and write the separate instructions for installing TensorFlow in each Dockerfile. Managing two Dockerfiles in this way improves readability and reduces build time.</p><p>Combining layers had performance benefits in older versions of Docker. However, since you cannot guarantee the Docker version in which your Docker containers will run, it is recommended to combine layers for readability purposes. It is best to combine layers that can be combined appropriately.</p><p>Here is an example of a Dockerfile:</p><div class="language-docker codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-docker codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Bad Case</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN apt-get update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN apt-get install build-essential -y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN apt-get install curl -y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN apt-get install jq -y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN apt-get install git -y</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This can be written by combining it as follows.</p><div class="language-docker codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-docker codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Better Case</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN apt-get update &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    apt-get install -y \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    build-essential \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    curl \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jq \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    git</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For convenience, it is better to use <code>.dockerignore</code>.<br>
<code>.dockerignore</code> is similar to <code>.gitignore</code> in the sense that it can be excluded when doing a <code>docker build</code> just like when doing a <code>git add</code>. </p><p>More information can be found in the <a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/" target="_blank" rel="noopener noreferrer">Docker Official Documentation</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="entrypoint-vs-cmd">ENTRYPOINT vs CMD<a href="#entrypoint-vs-cmd" class="hash-link" aria-label="Direct link to ENTRYPOINT vs CMD" title="Direct link to ENTRYPOINT vs CMD">​</a></h3><p><code>ENTRYPOINT</code> and <code>CMD</code> are both used when you want to execute a command at the runtime of the container. One of them must be present in the Dockerfile.</p><ul><li><strong>Difference</strong><ul><li><code>CMD</code>: Easily modifiable when running <code>docker run</code> command</li><li><code>ENTRYPOINT</code>: Requires the use of <code>--entrypoint</code> to modify</li></ul></li></ul><p>When <code>ENTRYPOINT</code> and <code>CMD</code> are used together, <code>CMD</code> typically represents the arguments (parameters) for the command specified in <code>ENTRYPOINT</code>.</p><p>For example, consider the following Dockerfile:</p><div class="language-docker codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-docker codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM ubuntu:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 아래 4 가지 option 을 바꿔가며 직접 테스트해보시면 이해하기 편합니다.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 단, NO ENTRYPOINT 옵션은 base image 인 ubuntu:latest 에 이미 있어서 테스트해볼 수는 없고 나머지 v2, 3, 5, 6, 8, 9, 11, 12 를 테스트해볼 수 있습니다.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ENTRYPOINT echo &quot;Hello ENTRYPOINT&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ENTRYPOINT [&quot;echo&quot;, &quot;Hello ENTRYPOINT&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># CMD echo &quot;Hello CMD&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># CMD [&quot;echo&quot;, &quot;Hello CMD&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you build and run the above <code>Dockerfile</code> with the parts marked as comments deactivated, you can get the following results: </p><table><thead><tr><th></th><th>No ENTRYPOINT</th><th>ENTRYPOINT a b</th><th>ENTRYPOINT <!-- -->[&quot;a&quot;, &quot;b&quot;]</th></tr></thead><tbody><tr><td><strong>NO CMD</strong></td><td>Error!</td><td>/bin/sh -c a b</td><td>a b</td></tr><tr><td><strong>CMD <!-- -->[&quot;x&quot;, &quot;y&quot;]</strong></td><td>x y</td><td>/bin/sh -c a b</td><td>a b x y</td></tr><tr><td><strong>CMD x y</strong></td><td>/bin/sh -c x y</td><td>/bin/sh -c a b</td><td>a b /bin/sh -c x y</td></tr></tbody></table><ul><li>In Kubernetes pod, <ul><li><code>ENTRYPOINT</code> corresponds to the command</li><li><code>CMD</code> corresponds to the arguments</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="naming-docker-tag">Naming docker tag<a href="#naming-docker-tag" class="hash-link" aria-label="Direct link to Naming docker tag" title="Direct link to Naming docker tag">​</a></h3><p>Recommend not using &quot;latest&quot; as a tag for a Docker image, as it is the default tag name and can be easily overwritten unintentionally.</p><p>It is important to ensure uniqueness of one image with one tag for the sake of collaboration and debugging in the production stage.<br>
<!-- -->Using the same tag for different contents can lead to dangling images, which are not shown in the <code>docker images</code> but still take up storage space.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="etc">ETC<a href="#etc" class="hash-link" aria-label="Direct link to ETC" title="Direct link to ETC">​</a></h3><ol><li>Logs and other information are stored separately from the container, not inside it.
This is because data written from within the container can be lost at any time.</li><li>Secrets and environment-dependent information should not be written directly into the Dockerfile but should be passed in via environment variables or a .env config file.</li><li>There is a <strong>linter</strong> for Dockerfiles, so it is useful to use it when collaborating.
<a href="https://github.com/hadolint/hadolint" target="_blank" rel="noopener noreferrer">https://github.com/hadolint/hadolint</a></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="several-options-for-docker-run">Several options for docker run<a href="#several-options-for-docker-run" class="hash-link" aria-label="Direct link to Several options for docker run" title="Direct link to Several options for docker run">​</a></h2><p>When using Docker containers, there are some inconveniences.
Specifically, Docker does not store any of the work done within the Docker container by default.
This is because Docker containers use isolated file systems. Therefore, it is difficult to share data between multiple Docker containers.</p><p>To solve this problem, there are two approaches offered by Docker.</p><p><img loading="lazy" alt="storage.png" src="/en/assets/images/storage-2d2649699364f46922716d1fe9b5470a.png" width="501" height="255" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="docker-volume">Docker volume<a href="#docker-volume" class="hash-link" aria-label="Direct link to Docker volume" title="Direct link to Docker volume">​</a></h4><ul><li>Use the Docker CLI to directly manage a resource called <code>volume</code>.</li><li>Create a specific directory under the Docker area (<code>/var/lib/docker</code>) on the host and mount that path to a Docker container.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="bind-mount">Bind mount<a href="#bind-mount" class="hash-link" aria-label="Direct link to Bind mount" title="Direct link to Bind mount">​</a></h4><ul><li>Mount a specific path on the host to a Docker container.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-use">How to use?<a href="#how-to-use" class="hash-link" aria-label="Direct link to How to use?" title="Direct link to How to use?">​</a></h4><p>The usage is through the same interface, using the <code>-v</code> option.<br>
<!-- -->However, when using volumes, you need to manage them directly by performing commands like <code>docker volume create</code>, <code>docker volume ls</code>, <code>docker volume rm</code>, etc.</p><ul><li><p>Docker volume</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -v my_volume:/app </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    nginx:latest</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Blind mount</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -v /home/user/some/path:/app </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    nginx:latest</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><p>When developing locally, bind mount can be convenient, but if you want to maintain a clean environment, using Docker volume and explicitly performing create and rm operations can be another approach.</p><p>The way storage is provided in Kubernetes ultimately relies on Docker&#x27;s bind mount as well.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-run-with-resource-limit">Docker run with resource limit<a href="#docker-run-with-resource-limit" class="hash-link" aria-label="Direct link to Docker run with resource limit" title="Direct link to Docker run with resource limit">​</a></h3><p>Basically, docker containers can <strong>fully utilize the CPU and memory resources of the host OS</strong>. However, when using this, depending on the resource situation of the host OS, docker containers may abnormally terminate due to issues such as <strong>OOM</strong>.
To address this problem, docker provides the <code>-m</code> <a href="https://docs.docker.com/config/containers/resource_constraints/#limit-a-containers-access-to-memory" target="_blank" rel="noopener noreferrer">option</a> which allows you to <strong>limit the usage of CPU and memory</strong> when running the docker container.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run -d -m 512m --memory-reservation</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">256m --name </span><span class="token number" style="color:#36acaa">512</span><span class="token plain">-limit ubuntu </span><span class="token function" style="color:#d73a49">sleep</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run -d -m 1g --memory-reservation</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">256m --name 1g-limit ubuntu </span><span class="token function" style="color:#d73a49">sleep</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3600</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After running the Docker above, you can check the usage through the &#x27;docker stats&#x27; command.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER ID   NAME        CPU %     MEM USAGE / LIMIT   MEM %     NET I/O       BLOCK I/O   PIDS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4ea1258e2e09   1g-limit    </span><span class="token number" style="color:#36acaa">0.00</span><span class="token plain">%     300KiB / 1GiB       </span><span class="token number" style="color:#36acaa">0.03</span><span class="token plain">%     1kB / 0B      0B / 0B     </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4edf94b9a3e5   </span><span class="token number" style="color:#36acaa">512</span><span class="token plain">-limit   </span><span class="token number" style="color:#36acaa">0.00</span><span class="token plain">%     296KiB / 512MiB     </span><span class="token number" style="color:#36acaa">0.06</span><span class="token plain">%     </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">.11kB / 0B   0B / 0B     </span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In Kubernetes, when you limit the CPU and memory resources of a pod resource, it is provided using this technique.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-run-with-restart-policy">docker run with restart policy<a href="#docker-run-with-restart-policy" class="hash-link" aria-label="Direct link to docker run with restart policy" title="Direct link to docker run with restart policy">​</a></h3><p>If there is a need to keep a particular container running continuously, the <code>--restart=always</code> option is provided to try to re-create the container immediately after it is terminated.</p><p>After entering the option, run the docker.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run --restart</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">always ubuntu</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Run <code>watch -n1 docker ps</code> to check if it is restarting.
If it is running normally, <code>Restarting (0)</code> will be printed in STATUS.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER ID   IMAGE     COMMAND   CREATED          STATUS                         PORTS     NAMES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a911850276e8   ubuntu    </span><span class="token string" style="color:#e3116c">&quot;bash&quot;</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">35</span><span class="token plain"> seconds ago   Restarting </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> seconds ago             hungry_vaughan</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><a href="https://docs.docker.com/engine/reference/commandline/run/#restart-policies---restart" target="_blank" rel="noopener noreferrer">https://docs.docker.com/engine/reference/commandline/run/#restart-policies---restart</a><ul><li>Provides options such as &quot;on-failure with max retries&quot; and &quot;always&quot;</li></ul></li></ul><p>When specifying the restart option for a job resource in Kubernetes, this approach is used.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="running-docker-run-as-a-background-process">Running docker run as a background process<a href="#running-docker-run-as-a-background-process" class="hash-link" aria-label="Direct link to Running docker run as a background process" title="Direct link to Running docker run as a background process">​</a></h3><p>By default, when running a Docker container, it is executed as a foreground process. This means that the terminal that launched the container is automatically attached to it, preventing you from running other commands.</p><p>Let&#x27;s try an example. Open two terminals, and in one terminal, continuously monitor <code>docker ps</code>, while in the other terminal, execute the following commands one by one and observe the behavior.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="first-practice">First Practice<a href="#first-practice" class="hash-link" aria-label="Direct link to First Practice" title="Direct link to First Practice">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run -it ubuntu </span><span class="token function" style="color:#d73a49">sleep</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You must remain stopped for 10 seconds and you cannot perform any other commands from that container. After 10 seconds, you can check in docker ps that the container has terminated.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="second-practice">Second Practice<a href="#second-practice" class="hash-link" aria-label="Direct link to Second Practice" title="Direct link to Second Practice">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run -it ubuntu </span><span class="token function" style="color:#d73a49">sleep</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After that, press <code>ctrl + p</code> -&gt; <code>ctrl + q</code>.</p><p>Now you can perform other commands in that terminal, and you can also see that the container is still alive for up to 10 seconds with <code>docker ps</code>. This situation, where you exit from the Docker container, is called &quot;detached&quot;. Docker provides an option to run containers in detached mode, which allows you to run the container in the background while executing the <code>run</code> command.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="third-practice">Third Practice<a href="#third-practice" class="hash-link" aria-label="Direct link to Third Practice" title="Direct link to Third Practice">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run -d ubuntu </span><span class="token function" style="color:#d73a49">sleep</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In detached mode, you can perform other actions in the terminal that executed the command.</p><p>It is good to use detached mode appropriately according to the situation.<br>
<!-- -->For example, when developing a backend API server that communicates with the DB, the backend API server needs to be constantly checked with hot-loading while changing the source code, but the DB does not need to be monitored, so it can be executed as follows.<br>
<!-- -->Run the DB container in detached mode, and run the backend API server in attached mode to follow the logs.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">​</a></h2><ul><li><a href="https://towardsdatascience.com/docker-storage-598e385f4efe" target="_blank" rel="noopener noreferrer">https://towardsdatascience.com/docker-storage-598e385f4efe</a></li><li><a href="https://vsupalov.com/docker-latest-tag/" target="_blank" rel="noopener noreferrer">https://vsupalov.com/docker-latest-tag/</a></li><li><a href="https://docs.microsoft.com/ko-kr/azure/container-registry/container-registry-image-tag-version" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/ko-kr/azure/container-registry/container-registry-image-tag-version</a></li><li><a href="https://stevelasker.blog/2018/03/01/docker-tagging-best-practices-for-tagging-and-versioning-docker-images/" target="_blank" rel="noopener noreferrer">https://stevelasker.blog/2018/03/01/docker-tagging-best-practices-for-tagging-and-versioning-docker-images/</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/mlops-for-all/mlops-for-all.github.io/tree/main/docs/prerequisites/docker/advanced.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-02-01T10:24:42.000Z">Feb 1, 2024</time></b> by <b>Aiden-Jeon</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/prerequisites/docker/images"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">[Practice] Docker images</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#making-a-good-docker-image" class="table-of-contents__link toc-highlight">Making a good Docker image</a><ul><li><a href="#considerations-to-make-docker-image" class="table-of-contents__link toc-highlight">Considerations to make Docker image:</a></li><li><a href="#entrypoint-vs-cmd" class="table-of-contents__link toc-highlight">ENTRYPOINT vs CMD</a></li><li><a href="#naming-docker-tag" class="table-of-contents__link toc-highlight">Naming docker tag</a></li><li><a href="#etc" class="table-of-contents__link toc-highlight">ETC</a></li></ul></li><li><a href="#several-options-for-docker-run" class="table-of-contents__link toc-highlight">Several options for docker run</a><ul><li><a href="#docker-run-with-resource-limit" class="table-of-contents__link toc-highlight">Docker run with resource limit</a></li><li><a href="#docker-run-with-restart-policy" class="table-of-contents__link toc-highlight">docker run with restart policy</a></li><li><a href="#running-docker-run-as-a-background-process" class="table-of-contents__link toc-highlight">Running docker run as a background process</a></li></ul></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://makinarocks.ai" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/en/img/makinarocks.png" alt="MakinaRocks" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/en/img/makinarocks.png" alt="MakinaRocks" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">Copyright © 2021-2023 MakinaRocks. Built with Docusaurus.</div></div></div></footer></div>
<script src="/en/assets/js/runtime~main.54b01194.js"></script>
<script src="/en/assets/js/main.2cd4f705.js"></script>
</body>
</html>